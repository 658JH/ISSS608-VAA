---
title: "Exercise 1: Age-sex pyramid of Singapore Population using R"
author: "Hou Tao"
date: "25 Jan 2023"
date-modified: "`r Sys.Date()`"
execute: 
  echo: true
  eval: true
  warning: false
format: html
editor: visual
---

# 1. Overview

In this Take-home exercise 2, I've chosen one of my classmate take-home exercise 1 submission and analyzed the charts regarding clarity and aesthetics. The original design will be remade using the data visualization principles and best practices learned from lessons 1 and 2.

The dataset used in take-home exercises 1 and 2 is from [*Singapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2022*](https://www.singstat.gov.sg/find-data/search-by-theme/population/geographic-distribution/latest-data){.external target="_blank"} from the [Department of Statistics, Singapore](https://www.singstat.gov.sg/){.external target="_blank"}, and processed by RStudio with tidyverse family of packages and visualized by ggplot2 and related packages.

# 2. Data Preparation

### Loading packages

```{r}
#| code-fold: false

pacman::p_load(dplyr, ggplot2, tidyverse)

```

### Import data

```{r}
#| code-fold: false

pop_data <- read_csv("./data/respopagesextod2022.csv", 
              col_types = list(
                              PA   = col_character(),
                              SZ   = col_character(),
                              AG   = col_character(),
                              Sex  = col_character(),
                              TOD  = col_character(),
                              Pop  = col_integer(),
                              Time = col_integer()
                            )
              )

AG_ORDER <- factor(c("a", "b", "c", "d"), levels = c("b", "c", "d", "a"))

```



### Data Attributes

| No. | Attribute Name | Description of Attribute   |
|:----|:---------------|:---------------------------|
| 1   | PA             | Planning Area              |
| 2   | SZ             | Subzone                    |
| 3   | AG             | Age Group                  |
| 4   | Sex            | Male or Female             |
| 5   | TOD            | Type of Dwelling           |
| 6   | Pop            | Size of Population         |
| 7   | Time           | Year of the data collected |


# 3. Critique

### 3.1 Original Design

The original design shown as below:

![](./data/orignial.png){fig-align="center"}

### 3.2 Zooming Horizontally 

Zoom in horizontally to view the two population area on the first row, shown as below:

![](./data/orignial-row.png){fig-align="center"}

### 3.3 Zooming Vertically

Zoom in vertically to view the three population areas on the first column from the orginal chart, shown as below:


![](./data/orignial-col.png){fig-align="center"}


### 3.2 Clarity

#### 3.2.1 Groupping on Age Groups

The original design shown on 3.1 has grouped 19 age groups into six main groups, but it does not provid charities on the new six group introduced, but introduced extra confusion to the chart.

For instance, group *10_to_14* has been grouped into *Early Working Age*, while the *legal working age* in Singapore starts from 14 but with limitations. [MOM](https://workclass.co/singapore/blogs/minimum-age-for-working-in-singapore/){.external target="_blank"}.

The age group *80_to_84* has been grouped into *oldest-old* on the chart, Publications such as [Suzman R, Riley MW. Introducing the "oldest old". Milbank Mem Fund Q Health Soc. 1985 Spring;63(2):177-86. PMID: 3846808.](https://pubmed.ncbi.nlm.nih.gov/3846808/){.external target="_blank"} shows that *oldest-old refers to those aged 85 and above*.

It is important to have the references on the chart published for new terms introduced, to avoid any misunderstand from the public.


(b) Data Revelation

The original design shown population size in percentile for all the planning areas, it does not reveal the real size of population between *Ang Mo Kio* and *Yishun*.

Refer to the plot below, the actual population size of *Yishun* from age group 25 to 64 are much large than *Ang Mo Kio*.


it provides 

```{r}

unique(pop_data['AG'])

```


with percentages can hide the actual size of population, however,

In contrast, the second chart can provide both the size and proportion of each category (e.g., Age Group (AG)) from a different group of data (e.g., Planning Area (PA)).


```{r fig.width = 15}
#| code-fold: false

pop_sum <- pop_data %>%
  filter(PA == "Ang Mo Kio" | PA == "Yishun") %>%
    group_by(PA, AG) %>%
      summarise(total = sum(Pop), .groups="keep")
  

pop_data %>%
  filter(PA == "Ang Mo Kio" | PA == "Yishun") %>%
        mutate(AG = fct_relevel(AG, "0_to_4","5_to_9")) %>%
          ggplot(aes(y = Pop, x = AG)) + 
          geom_bar(stat = "identity", 
                   color="lightblue", fill="lightblue", 
                   show.legend = FALSE) +
          geom_text(aes(AG, total, 
                        label = scales::comma(total), 
                        fill = NULL), 
                    data = pop_sum) +
          coord_flip() + 
          facet_wrap( ~ PA)+
          labs(x = "Age Group", 
               y = "Population Size", 
               title = "Population Size by Planning Area and Age Groups of Year 2022") +
          theme_bw()
```

```{r fig.width = 15}
#| code-fold: false

pop_sum <- pop_data %>%
  filter(PA == "Yishun" | PA == "Jurong West" ) %>%
    group_by(PA, AG) %>%
      summarise(total = sum(Pop), .groups="keep")
  

pop_data %>%
  filter(PA == "Yishun" | PA == "Jurong West" ) %>%
        mutate(AG = fct_relevel(AG, "0_to_4","5_to_9")) %>%
          ggplot(aes(y = Pop, x = AG)) + 
          geom_bar(stat = "identity", 
                   color="lightblue", fill="lightblue", 
                   show.legend = FALSE) +
          geom_text(aes(AG, total, 
                        label = scales::comma(total), 
                        fill = NULL), 
                    data = pop_sum) +
          coord_flip() + 
          facet_wrap( ~ PA)+
          labs(x = "Age Group", 
               y = "Population Size", 
               title = "Population Size by Planning Area and Age Groups of Year 2022") +
          theme_bw()
```


```{r}
#| code-fold: false

pop_sum <- pop_data %>%
  filter(PA == "Yishun" | PA == "Jurong West") %>%
    filter(Sex == "Males") %>%
      filter(AG %in% c("25_to_29", "30_to_34", "35_to_39", "40_to_44", "45_to_49","50_to_54")) %>%
        group_by(PA) %>%
          summarise(total = sum(Pop), .groups="keep")
  

pop_sum %>%
  ggplot(aes(y = total, x = PA)) + 
    geom_bar(stat = "identity", fill="lightblue", show.legend = FALSE) +
        geom_text(aes(PA, total, label = scales::comma(total), fill = NULL), data = pop_sum) +
          labs(x = "Planning Area", 
               y = "Population Size", 
               title = "Male Population Size from age 25 to 54 of Year 2022 between Jurong West and Yishun") +
          theme_bw()
```



(c) Age-sex pyramid chart


#### 3.3 Aesthetics

(a) Legend - Coloring

(c) X-Axis reference line


### 4. Sketch of Proposed Design


### 5. Remake


